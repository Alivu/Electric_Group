<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—Å–≤–µ—â–µ–Ω–∏—è | Electric Group</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --success: #27ae60;
            --warning: #f39c12;
            --ai-color: #6e48aa;
            --ai-secondary: #9d50bb;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .main-container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* –®–ê–ü–ö–ê */
        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-img {
            width: 200px;
            height: 100px;
            object-fit: contain;
            border-radius: 8px;
        }

        .header-title h1 {
            color: var(--primary);
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header-title p {
            color: var(--gray);
            font-size: 14px;
        }

        .contact-info {
            text-align: right;
        }

        .contact-item {
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
        }

        .contact-item i {
            color: var(--accent);
            width: 20px;
        }

        .phone-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .phone-link:hover {
            color: var(--accent);
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ */
        .mode-switcher {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 5px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 10px;
        }

        .mode-btn {
            flex: 1;
            padding: 12px 15px;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: var(--secondary);
            color: white;
            box-shadow: 0 3px 8px rgba(52, 152, 219, 0.3);
        }

        .mode-btn:not(.active):hover {
            background: #f8f9fa;
        }

        /* –û–°–ù–û–í–ù–û–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† */
        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .calculator-container {
                grid-template-columns: 1fr;
            }
        }

        .calc-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .calc-title {
            color: var(--primary);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calc-title i {
            color: var(--accent);
            font-size: 16px;
        }

        /* –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö */
        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 480px) {
            .input-section {
                grid-template-columns: 1fr;
            }
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--primary);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .input-group label i {
            color: var(--secondary);
            font-size: 12px;
        }

        .input-field {
            position: relative;
        }

        .input-field input, .input-field select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
            background: #f8fafc;
        }

        .input-field input:focus, .input-field select:focus {
            border-color: var(--secondary);
            outline: none;
            background: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .custom-lux-input {
            margin-top: 8px;
            display: none;
        }

        .custom-lux-input.active {
            display: block;
        }

        .unit {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            font-size: 12px;
        }

        .error-message {
            color: var(--accent);
            font-size: 11px;
            margin-top: 5px;
            display: none;
        }

        .calculate-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 15px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .calculate-btn:hover:not(:disabled) {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* –ö–Ω–æ–ø–∫–∞ AI-–∞–Ω–∞–ª–∏–∑–∞ */
        .ai-analyze-btn {
            background: linear-gradient(135deg, var(--ai-color) 0%, var(--ai-secondary) 100%);
            color: white;
            border: none;
            padding: 15px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(110, 72, 170, 0.3);
        }

        .ai-analyze-btn:hover {
            background: linear-gradient(135deg, #5d3a9b 0%, #8a2be2 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(110, 72, 170, 0.4);
        }

        .ai-analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* –†–ï–ó–£–õ–¨–¢–ê–¢–´ */
        .results-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .results-title {
            color: var(--primary);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .results-title i {
            color: var(--accent);
            font-size: 16px;
        }

        .basic-results {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 480px) {
            .basic-results {
                grid-template-columns: 1fr;
            }
        }

        .result-card {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e0e6ed;
            transition: all 0.3s ease;
        }

        .result-card.highlight {
            background: linear-gradient(135deg, #e8f4fc 0%, #d4eaf7 100%);
            border-color: var(--secondary);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.1);
        }

        .result-card i {
            font-size: 20px;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .result-label {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            line-height: 1.2;
        }

        .result-unit {
            font-size: 11px;
            color: var(--gray);
            margin-top: 5px;
            font-weight: 500;
        }

        /* –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–∏—Ö –ª–∞–º–ø */
        .lamps-toggle-btn {
            background: var(--warning);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin-top: 15px;
            margin-bottom: 20px;
        }

        .lamps-toggle-btn:hover {
            background: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(231, 126, 34, 0.3);
        }

        /* –°–µ–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –ª–∞–º–ø */
        .lamps-section {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.5s ease;
        }

        .lamps-section.active {
            display: block;
        }

        .lamps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .lamp-option {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lamp-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .lamp-option.selected {
            border-color: var(--success);
            background: #e8f5e9;
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.2);
        }

        .lamp-power {
            font-size: 22px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .lamp-lumens {
            font-size: 13px;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .lamp-count {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent);
            margin-top: 8px;
        }

        .lamp-socket {
            font-size: 11px;
            color: var(--gray);
            margin-top: 5px;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞—Ö */
        .coefficient-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            font-size: 13px;
            color: var(--dark);
            border-left: 4px solid var(--secondary);
        }

        .coefficient-info i {
            color: var(--secondary);
            margin-right: 8px;
        }

        .coefficient-info .highlight {
            color: var(--accent);
            font-weight: 700;
        }

        /* –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */
        .main-info {
            background: linear-gradient(135deg, var(--secondary) 0%, #2980b9 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .lux-result {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .lux-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .electrician-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        .electrician-info div {
            font-size: 13px;
        }

        .electrician-info strong {
            font-size: 16px;
        }

        .back-to-chat-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .back-to-chat-btn:hover {
            background: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }

        /* –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –≤—ã—Å–æ—Ç–µ */
        .height-warning {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            font-size: 13px;
            display: none;
            align-items: center;
            gap: 12px;
            animation: fadeIn 0.3s ease;
        }

        .height-warning.active {
            display: flex;
        }

        .height-warning i {
            font-size: 20px;
        }

        /* –í–´–î–í–ò–ñ–ù–û–ï –û–ö–ù–û AI-–ê–ù–ê–õ–ò–ó–ê */
        .ai-analysis-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .ai-analysis-panel.active {
            transform: translateY(0);
        }

        .ai-panel-header {
            background: linear-gradient(135deg, var(--ai-color) 0%, var(--ai-secondary) 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .ai-panel-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ai-panel-header h3 i {
            font-size: 22px;
        }

        .close-ai-panel {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 18px;
        }

        .close-ai-panel:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .ai-panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .ai-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--ai-color);
        }

        .ai-section-title {
            color: var(--ai-color);
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-section-title i {
            font-size: 15px;
        }

        .ai-option {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 12px;
            border: 1px solid #e0e6ed;
            transition: all 0.3s;
        }

        .ai-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 72, 170, 0.1);
            border-color: var(--ai-color);
        }

        .ai-option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .ai-option-title {
            font-weight: 700;
            color: var(--primary);
            font-size: 16px;
        }

        .ai-option-badge {
            background: linear-gradient(135deg, var(--ai-color) 0%, var(--ai-secondary) 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .ai-option-details {
            font-size: 14px;
            color: var(--dark);
            line-height: 1.5;
        }

        .ai-option-details ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .ai-option-details li {
            margin-bottom: 6px;
        }

        .ai-option-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e6ed;
        }

        .ai-stat {
            text-align: center;
        }

        .ai-stat-value {
            font-weight: 700;
            color: var(--ai-color);
            font-size: 15px;
        }

        .ai-stat-label {
            font-size: 12px;
            color: var(--gray);
            margin-top: 5px;
        }

        .ai-recommendation {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left-color: var(--success);
        }

        .ai-recommendation .ai-section-title {
            color: var(--success);
        }

        .ai-warning {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left-color: var(--warning);
        }

        .ai-warning .ai-section-title {
            color: var(--warning);
        }

        .ai-tips {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .ai-tip {
            background: white;
            border-radius: 8px;
            padding: 12px;
            font-size: 13px;
            text-align: center;
            border: 1px solid #e0e6ed;
        }

        .ai-tip i {
            color: var(--ai-color);
            margin-bottom: 8px;
            font-size: 16px;
        }

        .ai-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .ai-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ */
        .ai-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 50px 20px;
            text-align: center;
        }

        .ai-loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--ai-color);
            border-radius: 50%;
            animation: ai-spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes ai-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .ai-loading-text {
            color: var(--ai-color);
            font-weight: 600;
            font-size: 15px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* –§–£–¢–ï–† */
        .footer {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
            color: var(--gray);
            font-size: 14px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .footer-link:hover {
            color: var(--accent);
            text-decoration: underline;
        }

        /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .logo-section {
                flex-direction: column;
                text-align: center;
            }
            
            .contact-info {
                text-align: center;
            }
            
            .contact-item {
                justify-content: center;
            }
            
            .header-title h1 {
                font-size: 20px;
            }
            
            .calc-section, .results-section {
                padding: 20px;
            }
            
            .ai-panel-header h3 {
                font-size: 18px;
            }
            
            .ai-section {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .calc-title, .results-title {
                font-size: 16px;
            }
            
            .result-value {
                font-size: 20px;
            }
            
            .ai-option-stats {
                grid-template-columns: 1fr;
            }
            
            .ai-tips {
                grid-template-columns: 1fr;
            }
            
            .lux-result {
                font-size: 22px;
            }
            
            .electrician-info {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- –®–ê–ü–ö–ê -->
        <header class="header">
            <div class="logo-section">
                <img src="https://www.stom-firms.ru/i/customUsersImages/2026-01/img695e4c9ac1ca3.webp" 
                     class="logo-img" 
                     alt="ELECTRIC GROUP">
                <div class="header-title">
                    <h1><i class="fas fa-calculator"></i> –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—Å–≤–µ—â–µ–Ω–∏—è + AI</h1>
                    <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –æ—Å–≤–µ—â–µ–Ω–∏—è –¥–ª—è –ª—é–±—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π</p>
                </div>
            </div>
            
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-phone-alt"></i>
                    <a href="tel:+79635984846" class="phone-link">+7 (963) 598-48-46</a>
                </div>
                <div class="contact-item">
                    <i class="fas fa-user"></i>
                    <span>–ê–ª–∏ (—ç–ª–µ–∫—Ç—Ä–∏–∫)</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-clock"></i>
                    <span>–ü–Ω-–í—Å 8:00-18:00</span>
                </div>
            </div>
        </header>

        <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
        <div class="calculator-container">
            <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –í–í–û–î –î–ê–ù–ù–´–• -->
            <section class="calc-section">
                <h2 class="calc-title">
                    <i class="fas fa-cogs"></i> –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏—è
                </h2>
                
                <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ -->
                <div class="mode-switcher">
                    <button class="mode-btn active" id="modeSnipBtn">
                        <i class="fas fa-file-contract"></i> –°–ù–∏–ü (–Ω–æ—Ä–º—ã)
                    </button>
                    <button class="mode-btn" id="modeComfortBtn">
                        <i class="fas fa-couch"></i> –ö–æ–º—Ñ–æ—Ä—Ç
                    </button>
                </div>
                
                <div class="input-section">
                    <div class="input-group">
                        <label for="length"><i class="fas fa-ruler-horizontal"></i> –î–ª–∏–Ω–∞ –ø–æ–º–µ—â–µ–Ω–∏—è</label>
                        <div class="input-field">
                            <input type="number" id="length" min="0.1" max="100" step="0.1" value="5.0" required>
                            <span class="unit">–º</span>
                        </div>
                        <div class="error-message" id="lengthError">0.1-100 –º</div>
                    </div>
                    
                    <div class="input-group">
                        <label for="width"><i class="fas fa-ruler-vertical"></i> –®–∏—Ä–∏–Ω–∞ –ø–æ–º–µ—â–µ–Ω–∏—è</label>
                        <div class="input-field">
                            <input type="number" id="width" min="0.1" max="100" step="0.1" value="4.0" required>
                            <span class="unit">–º</span>
                        </div>
                        <div class="error-message" id="widthError">0.1-100 –º</div>
                    </div>
                    
                    <div class="input-group">
                        <label for="height"><i class="fas fa-arrows-alt-v"></i> –í—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–æ–≤</label>
                        <div class="input-field">
                            <input type="number" id="height" min="1.5" max="15" step="0.1" value="2.7" required>
                            <span class="unit">–º</span>
                        </div>
                        <div class="error-message" id="heightError">1.5-15 –º</div>
                    </div>
                    
                    <div class="input-group">
                        <label for="roomType"><i class="fas fa-building"></i> –¢–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è</label>
                        <div class="input-field">
                            <select id="roomType">
                                <option value="50">–ö–æ—Ä–∏–¥–æ—Ä—ã, —Å–∞–Ω—É–∑–ª—ã (50 –ª–∫)</option>
                                <option value="150" selected>–ñ–∏–ª—ã–µ –∫–æ–º–Ω–∞—Ç—ã, –∫—É—Ö–Ω–∏ (150 –ª–∫)</option>
                                <option value="200">–î–µ—Ç—Å–∫–∏–µ –∫–æ–º–Ω–∞—Ç—ã (200 –ª–∫)</option>
                                <option value="300">–ö–∞–±–∏–Ω–µ—Ç—ã, –û—Ñ–∏—Å—ã (300 –ª–∫)</option>
                                <option value="400">–¢–æ—Ä–≥–æ–≤—ã–µ –∑–∞–ª—ã (400 –ª–∫)</option>
                                <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π...</option>
                            </select>
                        </div>
                        <div class="custom-lux-input" id="customLuxInput">
                            <input type="number" id="customLux" min="1" max="10000" step="1" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª—é–∫—Å—ã" value="150">
                        </div>
                    </div>
                </div>
                
                <button class="calculate-btn" id="calculateBtn">
                    <i class="fas fa-bolt"></i> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ
                </button>
                
                <button class="ai-analyze-btn" id="aiAnalyzeBtn" disabled>
                    <i class="fas fa-robot"></i> AI –ê–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                </button>
                
                <div class="height-warning" id="heightWarning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <div>
                        <strong>–í—ã—Å–æ–∫–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ!</strong> –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤—ã—Å–æ—Ç—ã: <span id="heightMultiplier">√ó1.0</span>
                    </div>
                </div>
            </section>

            <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –†–ï–ó–£–õ–¨–¢–ê–¢–´ -->
            <section class="results-section">
                <h2 class="results-title">
                    <i class="fas fa-chart-line"></i> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞
                </h2>
                
                <div id="emptyResults" style="text-align: center; padding: 60px 0; color: var(--gray);">
                    <i class="fas fa-calculator" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                    <p style="font-size: 16px;">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å"</p>
                </div>
                
                <div id="results" style="display: none;">
                    <div class="basic-results">
                        <div class="result-card">
                            <i class="fas fa-expand-arrows-alt"></i>
                            <div class="result-label">–ü–ª–æ—â–∞–¥—å</div>
                            <div class="result-value" id="areaResult">20.0</div>
                            <div class="result-unit">–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç—Ä–æ–≤</div>
                        </div>
                        
                        <div class="result-card">
                            <i class="fas fa-lightbulb"></i>
                            <div class="result-label">–û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å</div>
                            <div class="result-value" id="luxResult">150</div>
                            <div class="result-unit" id="luxUnit">–ª–∫ (–°–ù–∏–ü)</div>
                        </div>
                        
                        <div class="result-card highlight">
                            <i class="fas fa-sun"></i>
                            <div class="result-label">–°–≤–µ—Ç–æ–≤–æ–π –ø–æ—Ç–æ–∫</div>
                            <div class="result-value" id="lumenResult">7200</div>
                            <div class="result-unit">–ª—é–º–µ–Ω</div>
                        </div>
                        
                        <div class="result-card">
                            <i class="fas fa-plug"></i>
                            <div class="result-label">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ LED</div>
                            <div class="result-value" id="lampsResult">9</div>
                            <div class="result-unit" id="lampsUnit">—à—Ç √ó 800–ª–º</div>
                        </div>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–∏—Ö –ª–∞–º–ø -->
                    <button class="lamps-toggle-btn" id="lampsToggleBtn">
                        <i class="fas fa-lightbulb"></i> –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –ª–∞–º–ø
                    </button>
                    
                    <!-- –°–µ–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –ª–∞–º–ø -->
                    <div class="lamps-section" id="lampsSection">
                        <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 15px;">
                            <i class="fas fa-list"></i> –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Å–≤–µ—â–µ–Ω–∏—è:
                        </h4>
                        <div class="lamps-grid" id="lampsGrid">
                            <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –ª–∞–º–ø –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                    </div>
                    
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞—Ö -->
					<div class="coefficient-info">
					<i class="fas fa-calculator"></i> 
					–§–æ—Ä–º—É–ª–∞: (–õ—é–∫—Å √ó –ü–ª–æ—â–∞–¥—å √ó <span class="highlight" id="reserveValue">1.2</span> √ó <span class="highlight" id="heightCoefficient">1.0</span>) √∑ 
						<span class="highlight" id="coefficientValue">0.5</span> = 
						√ó<span class="highlight" id="totalMultiplier">2.4</span>
						</div>
                    
                    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                    <div class="main-info">
                        <div class="lux-result" id="totalLuxResult">150 –ª–∫ (–°–ù–∏–ü)</div>
                        <div class="lux-label" id="modeLabel">–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –°–ù–∏–ü</div>
                        
                        <div class="electrician-info">
                            <div>
                                <div>–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —ç–ª–µ–∫—Ç—Ä–∏–∫–∞:</div>
                                <strong>+7 (963) 598-48-46</strong>
                            </div>
                            <a href="index.html" class="back-to-chat-btn">
                                <i class="fas fa-comments"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ —á–∞—Ç
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- –§–£–¢–ï–† -->
        <footer class="footer">
            <p>¬© 2024 Electric Group. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã</p>
            <div class="footer-links">
                <a href="index.html" class="footer-link"><i class="fas fa-comments"></i> –ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏</a>
                <a href="https://alivu.github.io/electro-smeta/" target="_blank" class="footer-link"><i class="fas fa-file-invoice-dollar"></i> –≠–ª–µ–∫—Ç—Ä–æ–°–º–µ—Ç–∞</a>
                <a href="tel:+79635984846" class="footer-link"><i class="fas fa-phone"></i> –ü–æ–∑–≤–æ–Ω–∏—Ç—å</a>
            </div>
        </footer>
    </div>

    <!-- –í–´–î–í–ò–ñ–ù–û–ï –û–ö–ù–û AI-–ê–ù–ê–õ–ò–ó–ê -->
    <div class="ai-overlay" id="aiOverlay"></div>
    
    <div class="ai-analysis-panel" id="aiAnalysisPanel">
        <div class="ai-panel-header">
            <h3><i class="fas fa-robot"></i> AI –ê–Ω–∞–ª–∏–∑ –æ—Å–≤–µ—â–µ–Ω–∏—è</h3>
            <button class="close-ai-panel" id="closeAiPanel">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="ai-panel-content" id="aiPanelContent">
            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ AI –∞–Ω–∞–ª–∏–∑–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </div>
    </div>

    <script>
        // ==================== –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´ –î–õ–Ø –†–ê–°–ß–ï–¢–ê ====================
        const COEFFICIENTS = {
            utilization: {
                '–ö–æ—Ä–∏–¥–æ—Ä—ã, —Å–∞–Ω—É–∑–ª—ã (50 –ª–∫)': 0.5,
                '–ñ–∏–ª—ã–µ –∫–æ–º–Ω–∞—Ç—ã, –∫—É—Ö–Ω–∏ (150 –ª–∫)': 0.75,
                '–î–µ—Ç—Å–∫–∏–µ –∫–æ–º–Ω–∞—Ç—ã (200 –ª–∫)': 0.75,
                '–ö–∞–±–∏–Ω–µ—Ç—ã, –û—Ñ–∏—Å—ã (300 –ª–∫)': 0.65,
                '–¢–æ—Ä–≥–æ–≤—ã–µ –∑–∞–ª—ã (400 –ª–∫)': 0.75,
                '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π...': 0.65
            },
            
            reserve: 1.2,
            
            comfortMultipliers: {
                '–ö–æ—Ä–∏–¥–æ—Ä—ã, —Å–∞–Ω—É–∑–ª—ã (50 –ª–∫)': 2.0,
                '–ñ–∏–ª—ã–µ –∫–æ–º–Ω–∞—Ç—ã, –∫—É—Ö–Ω–∏ (150 –ª–∫)': 1.5,
                '–î–µ—Ç—Å–∫–∏–µ –∫–æ–º–Ω–∞—Ç—ã (200 –ª–∫)': 1.5,
                '–ö–∞–±–∏–Ω–µ—Ç—ã, –û—Ñ–∏—Å—ã (300 –ª–∫)': 1.5,
                '–¢–æ—Ä–≥–æ–≤—ã–µ –∑–∞–ª—ã (400 –ª–∫)': 1.5,
                '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π...': 1.5
            },
            
            heightMultipliers: [
                { max: 2.5, multiplier: 1.0, label: '–ù–∏–∑–∫–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ' },
                { max: 3.0, multiplier: 1.1, label: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞' },
                { max: 3.5, multiplier: 1.2, label: '–ù–µ–º–Ω–æ–≥–æ –≤—ã—à–µ' },
                { max: 4.0, multiplier: 1.5, label: '–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞' },
                { max: 4.5, multiplier: 1.8, label: '–í—ã—Å–æ–∫–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ' },
                { max: 5.5, multiplier: 2.2, label: '–û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ' },
                { max: 6.5, multiplier: 2.8, label: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ' },
                { max: 8.0, multiplier: 3.5, label: '–°–∫–ª–∞–¥—Å–∫–æ–µ' },
                { max: 10.0, multiplier: 4.5, label: '–ê–Ω–≥–∞—Ä–Ω–æ–µ' },
                { max: 15.0, multiplier: 6.0, label: '–í—ã—Å–æ—Ç–Ω–æ–µ' }
            ]
        };

        // ==================== –≠–õ–ï–ú–ï–ù–¢–´ DOM ====================
        const modeSnipBtn = document.getElementById('modeSnipBtn');
        const modeComfortBtn = document.getElementById('modeComfortBtn');
        const lengthInput = document.getElementById('length');
        const widthInput = document.getElementById('width');
        const heightInput = document.getElementById('height');
        const roomTypeSelect = document.getElementById('roomType');
        const customLuxInput = document.getElementById('customLuxInput');
        const customLux = document.getElementById('customLux');
        const calculateBtn = document.getElementById('calculateBtn');
        const aiAnalyzeBtn = document.getElementById('aiAnalyzeBtn');
        const resultsDiv = document.getElementById('results');
        const emptyResultsDiv = document.getElementById('emptyResults');
        const areaResult = document.getElementById('areaResult');
        const luxResult = document.getElementById('luxResult');
        const luxUnit = document.getElementById('luxUnit');
        const lumenResult = document.getElementById('lumenResult');
        const lampsResult = document.getElementById('lampsResult');
        const lampsUnit = document.getElementById('lampsUnit');
        const totalLuxResult = document.getElementById('totalLuxResult');
        const modeLabel = document.getElementById('modeLabel');
        const coefficientValue = document.getElementById('coefficientValue');
        const reserveValue = document.getElementById('reserveValue');
        const heightCoefficient = document.getElementById('heightCoefficient');
        const totalMultiplier = document.getElementById('totalMultiplier');
        const heightWarning = document.getElementById('heightWarning');
        const heightMultiplier = document.getElementById('heightMultiplier');
        const lampsToggleBtn = document.getElementById('lampsToggleBtn');
        const lampsSection = document.getElementById('lampsSection');
        const lampsGrid = document.getElementById('lampsGrid');
        
        // AI –ø–∞–Ω–µ–ª—å —ç–ª–µ–º–µ–Ω—Ç—ã
        const aiOverlay = document.getElementById('aiOverlay');
        const aiAnalysisPanel = document.getElementById('aiAnalysisPanel');
        const closeAiPanel = document.getElementById('closeAiPanel');
        const aiPanelContent = document.getElementById('aiPanelContent');

        // ==================== –ü–ï–†–ï–ú–ï–ù–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø ====================
        let currentMode = 'snip';
        let requiredLumens = 0;
        let heightMultiplierValue = 1.0;
        let calculationData = null;

        // ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –†–ï–ñ–ò–ú–û–í ====================
        modeSnipBtn.addEventListener('click', () => setMode('snip'));
        modeComfortBtn.addEventListener('click', () => setMode('comfort'));

        function setMode(mode) {
            currentMode = mode;
            modeSnipBtn.classList.toggle('active', mode === 'snip');
            modeComfortBtn.classList.toggle('active', mode === 'comfort');
            calculateIllumination();
        }

        // ==================== –û–ë–†–ê–ë–û–¢–ö–ê –í–´–ë–û–†–ê –¢–ò–ü–ê –ü–û–ú–ï–©–ï–ù–ò–Ø ====================
        roomTypeSelect.addEventListener('change', function() {
            if (this.value === 'custom') {
                customLuxInput.classList.add('active');
                customLux.focus();
            } else {
                customLuxInput.classList.remove('active');
            }
            debouncedCalculate();
        });

        customLux.addEventListener('input', debouncedCalculate);

        // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï AI –ü–ê–ù–ï–õ–¨–Æ ====================
        aiAnalyzeBtn.addEventListener('click', () => {
            if (calculationData) {
                openAIPanel();
            }
        });

        closeAiPanel.addEventListener('click', closeAIPanel);
        aiOverlay.addEventListener('click', closeAIPanel);

        function openAIPanel() {
            aiOverlay.classList.add('active');
            aiAnalysisPanel.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            aiPanelContent.innerHTML = `
                <div class="ai-loading">
                    <div class="ai-loading-spinner"></div>
                    <div class="ai-loading-text">AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–º–µ—â–µ–Ω–∏–µ –∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è...</div>
                </div>
            `;
            
            setTimeout(() => {
                generateAIAnalysis();
            }, 800);
        }

        function closeAIPanel() {
            aiOverlay.classList.remove('active');
            aiAnalysisPanel.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // ==================== AI –ê–ù–ê–õ–ò–ó ====================
        function generateAIAnalysis() {
            const data = calculationData;
            const area = data.area;
            const roomType = data.roomTypeText.toLowerCase();
            
            const solutions = generateLightingSolutions(data);
            
            let html = `
                <div class="ai-section">
                    <div class="ai-section-title">
                        <i class="fas fa-info-circle"></i>
                        –ê–Ω–∞–ª–∏–∑ –ø–æ–º–µ—â–µ–Ω–∏—è
                    </div>
                    <div class="ai-option">
                        <div class="ai-option-details">
                            <p><strong>üìê –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</strong> ${data.length} √ó ${data.width} √ó ${data.height}–º = ${area.toFixed(1)} –º¬≤</p>
                            <p><strong>üéØ –¶–µ–ª–µ–≤–∞—è –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å:</strong> ${data.targetLux} –ª–∫ (${data.modeText})</p>
                            <p><strong>üí° –¢—Ä–µ–±—É–µ–º—ã–π —Å–≤–µ—Ç–æ–≤–æ–π –ø–æ—Ç–æ–∫:</strong> ${data.requiredLumens.toLocaleString()} –ª–º</p>
                            <p><strong>üìä –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ–º–µ—â–µ–Ω–∏—è:</strong> ${getRoomCategory(area, data.height)}</p>
                        </div>
                        <div class="ai-option-stats">
                            <div class="ai-stat">
                                <div class="ai-stat-value">${getAreaStatus(area)}</div>
                                <div class="ai-stat-label">–ü–ª–æ—â–∞–¥—å</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value">${getHeightStatus(data.height)}</div>
                                <div class="ai-stat-label">–í—ã—Å–æ—Ç–∞</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value">${getRoomTypeComplexity(roomType)}</div>
                                <div class="ai-stat-label">–°–ª–æ–∂–Ω–æ—Å—Ç—å</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ai-section ai-recommendation">
                    <div class="ai-section-title">
                        <i class="fas fa-star"></i>
                        –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è AI
                    </div>
                    <div class="ai-option">
                        <div class="ai-option-header">
                            <div class="ai-option-title">${solutions.recommended.name}</div>
                            <div class="ai-option-badge">–õ—É—á—à–∏–π –≤—ã–±–æ—Ä</div>
                        </div>
                        <div class="ai-option-details">
                            ${solutions.recommended.description}
                            <ul>
                                ${solutions.recommended.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="ai-option-stats">
                            <div class="ai-stat">
                                <div class="ai-stat-value">${solutions.recommended.count}</div>
                                <div class="ai-stat-label">–®—Ç.</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value">${solutions.recommended.totalPower} –í—Ç</div>
                                <div class="ai-stat-label">–ú–æ—â–Ω–æ—Å—Ç—å</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value">${solutions.recommended.coverage}</div>
                                <div class="ai-stat-label">–ü–æ–∫—Ä—ã—Ç–∏–µ</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ai-section">
                    <div class="ai-section-title">
                        <i class="fas fa-lightbulb"></i>
                        –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
                    </div>
                
                    ${solutions.alternatives.map(alt => `
                    <div class="ai-option">
                        <div class="ai-option-header">
                            <div class="ai-option-title">${alt.name}</div>
                            <div class="ai-option-badge">${alt.type}</div>
                        </div>
                        <div class="ai-option-details">
                            ${alt.description}
                            <div class="ai-option-stats">
                                <div class="ai-stat">
                                    <div class="ai-stat-value">${alt.count}</div>
                                    <div class="ai-stat-label">–®—Ç.</div>
                                </div>
                                <div class="ai-stat">
                                    <div class="ai-stat-value">${alt.totalPower} –í—Ç</div>
                                    <div class="ai-stat-label">–ú–æ—â–Ω–æ—Å—Ç—å</div>
                                </div>
                                <div class="ai-stat">
                                    <div class="ai-stat-value">${alt.installation}</div>
                                    <div class="ai-stat-label">–ú–æ–Ω—Ç–∞–∂</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    `).join('')}
                </div>
                
                <div class="ai-section">
                    <div class="ai-section-title">
                        <i class="fas fa-tools"></i>
                        –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã
                    </div>
                    <div class="ai-tips">
                        <div class="ai-tip">
                            <i class="fas fa-ruler-combined"></i>
                            –®–∞–≥ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è: ${solutions.placement.spacing.toFixed(1)}–º
                        </div>
                        <div class="ai-tip">
                            <i class="fas fa-sun"></i>
                            –¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: ${getRecommendedColorTemperature(roomType)}
                        </div>
                        <div class="ai-tip">
                            <i class="fas fa-bolt"></i>
                            –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: ~${solutions.energyConsumption.toFixed(1)} –∫–í—Ç¬∑—á/–º–µ—Å
                        </div>
                        <div class="ai-tip">
                            <i class="fas fa-money-bill-wave"></i>
                            –û–∫—É–ø–∞–µ–º–æ—Å—Ç—å: ${solutions.payback} –ª–µ—Ç
                        </div>
                    </div>
                </div>
                
                <div class="ai-section ai-warning">
                    <div class="ai-section-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—ã—Å–æ—Ç—ã ${data.height}–º
                    </div>
                    <div class="ai-option">
                        <div class="ai-option-details">
                            ${getHeightSpecificTips(data.height, area)}
                        </div>
                    </div>
                </div>
            `;
            
            aiPanelContent.innerHTML = html;
            aiPanelContent.scrollTop = 0;
        }

        function generateLightingSolutions(data) {
            const area = data.area;
            const height = data.height;
            const roomType = data.roomTypeText.toLowerCase();
            
            let solutions = {
                recommended: null,
                alternatives: [],
                placement: { spacing: 1.5, pattern: '—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è —Å–µ—Ç–∫–∞' },
                energyConsumption: 0,
                payback: '3-5'
            };
            
            if (area > 50) {
                const largeChandeliersCount = Math.max(2, Math.ceil(area / 40));
                const hornsPerChandelier = area > 80 ? 24 : 18;
                const lampPower = area > 80 ? 40 : 30;
                const totalLamps = largeChandeliersCount * hornsPerChandelier;
                const totalPower = totalLamps * lampPower;
                
                solutions.recommended = {
                    name: `–°–∏—Å—Ç–µ–º–∞ –∏–∑ ${largeChandeliersCount} –±–æ–ª—å—à–∏—Ö –ª—é—Å—Ç—Ä`,
                    type: '–õ—é—Å—Ç—Ä—ã',
                    count: largeChandeliersCount,
                    totalPower: totalPower,
                    coverage: '–ü–æ–ª–Ω–æ–µ',
                    description: `–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–æ–º–µ—â–µ–Ω–∏–π. ${largeChandeliersCount} –ª—é—Å—Ç—Ä—ã –ø–æ ${hornsPerChandelier} —Ä–æ–∂–∫–æ–≤ –∫–∞–∂–¥–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ –±–µ–∑ —Ç–µ–Ω–µ–≤—ã—Ö –∑–æ–Ω.`,
                    benefits: [
                        '–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤–µ—Ç–∞',
                        '–í–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥',
                        '–õ–µ–≥–∫–æ—Å—Ç—å –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏',
                        '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ç–∞'
                    ]
                };
                
                const projectorsCount = Math.ceil(area / 30);
                solutions.alternatives.push({
                    name: `–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞`,
                    type: '–ü—Ä–æ–∂–µ–∫—Ç–æ—Ä—ã + –õ—é—Å—Ç—Ä—ã',
                    count: projectorsCount + 1,
                    totalPower: (projectorsCount * 100) + 600,
                    installation: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π',
                    description: `${projectorsCount} –º–æ—â–Ω—ã—Ö –ø—Ä–æ–∂–µ–∫—Ç–æ—Ä–æ–≤ –ø–æ –ø–µ—Ä–∏–º–µ—Ç—Ä—É + —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª—é—Å—Ç—Ä–∞. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø–æ–º–µ—â–µ–Ω–∏–π —Å–ª–æ–∂–Ω–æ–π —Ñ–æ—Ä–º—ã.`
                });
                
                const panelsCount = Math.ceil(area / 9);
                solutions.alternatives.push({
                    name: `–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ`,
                    type: 'LED –ü–∞–Ω–µ–ª–∏',
                    count: panelsCount,
                    totalPower: panelsCount * 36,
                    installation: '–ü–æ–¥–≤–µ—Å–Ω–æ–π –ø–æ—Ç–æ–ª–æ–∫',
                    description: `${panelsCount} LED –ø–∞–Ω–µ–ª–µ–π 60√ó60—Å–º. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –≤–∏–¥, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.`
                });
                
                solutions.placement.spacing = Math.sqrt(area / largeChandeliersCount);
                solutions.energyConsumption = (totalPower * 5 * 30) / 1000;
                
            } else if (area >= 20) {
                const chandelierHorns = area > 30 ? 12 : 8;
                const spotlightsCount = Math.max(4, Math.ceil((area - 15) / 4));
                
                solutions.recommended = {
                    name: `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª—é—Å—Ç—Ä–∞ + –ø–µ—Ä–∏—Ñ–µ—Ä–∏–π–Ω—ã–µ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏`,
                    type: '–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞',
                    count: 1 + spotlightsCount,
                    totalPower: (chandelierHorns * 20) + (spotlightsCount * 9),
                    coverage: '–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ',
                    description: `–õ—é—Å—Ç—Ä–∞ –Ω–∞ ${chandelierHorns} —Ä–æ–∂–∫–æ–≤ –≤ —Ü–µ–Ω—Ç—Ä–µ + ${spotlightsCount} —Ç–æ—á–µ—á–Ω—ã—Ö —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–æ–≤ –ø–æ –ø–µ—Ä–∏–º–µ—Ç—Ä—É. –ë–∞–ª–∞–Ω—Å –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.`,
                    benefits: [
                        '–ì–∏–±–∫–æ–µ –∑–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–≤–µ—â–µ–Ω–∏—è',
                        '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ —è—Ä–∫–æ—Å—Ç–∏',
                        '–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–±–æ–≥–æ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞',
                        '–õ–µ–≥–∫–æ—Å—Ç—å –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏'
                    ]
                };
                
                const chandeliersCount = 2;
                solutions.alternatives.push({
                    name: `${chandeliersCount} –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ª—é—Å—Ç—Ä—ã`,
                    type: '–õ—é—Å—Ç—Ä—ã',
                    count: chandeliersCount,
                    totalPower: chandeliersCount * 8 * 20,
                    installation: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π',
                    description: `${chandeliersCount} –ª—é—Å—Ç—Ä—ã –ø–æ 8 —Ä–æ–∂–∫–æ–≤, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ.`
                });
                
                solutions.placement.spacing = 1.8;
                solutions.energyConsumption = (solutions.recommended.totalPower * 5 * 30) / 1000;
                
            } else {
                const chandelierHorns = area > 10 ? 5 : 3;
                
                solutions.recommended = {
                    name: `–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª—é—Å—Ç—Ä–∞ –Ω–∞ ${chandelierHorns} —Ä–æ–∂–∫–æ–≤`,
                    type: '–õ—é—Å—Ç—Ä–∞',
                    count: 1,
                    totalPower: chandelierHorns * 9,
                    coverage: '–ü–æ–ª–Ω–æ–µ',
                    description: `–°—Ç–∏–ª—å–Ω–∞—è –ª—é—Å—Ç—Ä–∞ —Å ${chandelierHorns} —Ä–æ–∂–∫–∞–º–∏ –æ–±–µ—Å–ø–µ—á–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ –∏ —Å—Ç–∞–Ω–µ—Ç —É–∫—Ä–∞—à–µ–Ω–∏–µ–º –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞.`,
                    benefits: [
                        '–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞',
                        '–ü—Ä–æ—Å—Ç–æ—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏',
                        '–®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –¥–∏–∑–∞–π–Ω–æ–≤',
                        '–ù–∏–∑–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ'
                    ]
                };
                
                const spotlightsCount = Math.ceil(area / 2.5);
                solutions.alternatives.push({
                    name: `${spotlightsCount} —Ç–æ—á–µ—á–Ω—ã—Ö —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–æ–≤`,
                    type: '–°–ø–æ—Ç—ã',
                    count: spotlightsCount,
                    totalPower: spotlightsCount * 9,
                    installation: '–í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ',
                    description: `–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. ${spotlightsCount} —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–æ–≤ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç —Å–≤–µ—Ç.`
                });
                
                solutions.placement.spacing = 1.2;
                solutions.energyConsumption = (solutions.recommended.totalPower * 5 * 30) / 1000;
            }
            
            if (height > 3.5) {
                solutions.recommended.description += ` –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–µ–Ω–æ –≤—ã—Å–æ—Ç–µ –ø–æ–º–µ—â–µ–Ω–∏—è (${height}–º) - —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ã —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏ —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º —Å–≤–µ—Ç–æ–º.`;
                solutions.placement.pattern = '—Å —É—á–µ—Ç–æ–º –≤—ã—Å–æ—Ç—ã, —É–≤–µ–ª–∏—á–µ–Ω —à–∞–≥';
            }
            
            if (roomType.includes('–æ—Ñ–∏—Å') || roomType.includes('—Ç–æ—Ä–≥–æ–≤')) {
                solutions.payback = '1-2';
                solutions.energyConsumption *= 2;
            }
            
            return solutions;
        }

        function getRoomCategory(area, height) {
            if (area < 10) return '–ú–∞–ª–µ–Ω—å–∫–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
            if (area < 20) return '–ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
            if (area < 35) return '–°—Ä–µ–¥–Ω–µ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
            if (area < 50) return '–ü—Ä–æ—Å—Ç–æ—Ä–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
            if (area < 80) return '–ë–æ–ª—å—à–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
            if (area < 120) return '–û—á–µ–Ω—å –±–æ–ª—å—à–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
            return '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ/–∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ';
        }

        function getAreaStatus(area) {
            if (area < 15) return '–ú–∞–ª–µ–Ω—å–∫–∞—è';
            if (area < 30) return '–°—Ä–µ–¥–Ω—è—è';
            if (area < 50) return '–ë–æ–ª—å—à–∞—è';
            if (area < 80) return '–û—á–µ–Ω—å –±–æ–ª—å—à–∞—è';
            return '–ì–∏–≥–∞–Ω—Ç—Å–∫–∞—è';
        }

        function getHeightStatus(height) {
            if (height < 2.5) return '–ù–∏–∑–∫–∞—è';
            if (height < 3.0) return '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è';
            if (height < 3.5) return '–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è';
            if (height < 4.5) return '–í—ã—Å–æ–∫–∞—è';
            return '–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è';
        }

        function getRoomTypeComplexity(roomType) {
            if (roomType.includes('–¥–µ—Ç—Å–∫')) return '–í—ã—Å–æ–∫–∞—è';
            if (roomType.includes('–æ—Ñ–∏—Å') || roomType.includes('–∫–∞–±–∏–Ω–µ—Ç')) return '–°—Ä–µ–¥–Ω—è—è';
            if (roomType.includes('—Ç–æ—Ä–≥–æ–≤')) return '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è';
            return '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è';
        }

        function getRecommendedColorTemperature(roomType) {
            if (roomType.includes('–¥–µ—Ç—Å–∫') || roomType.includes('–∂–∏–ª')) {
                return '2700-3000K (—Ç–µ–ø–ª—ã–π –±–µ–ª—ã–π)';
            } else if (roomType.includes('–æ—Ñ–∏—Å') || roomType.includes('–∫–∞–±–∏–Ω–µ—Ç')) {
                return '4000-4500K (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –±–µ–ª—ã–π)';
            } else if (roomType.includes('—Ç–æ—Ä–≥–æ–≤')) {
                return '5000-6000K (—Ö–æ–ª–æ–¥–Ω—ã–π –±–µ–ª—ã–π)';
            } else if (roomType.includes('—Å–∞–Ω—É–∑')) {
                return '3000-3500K (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)';
            } else {
                return '3000-4000K (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)';
            }
        }

        function getHeightSpecificTips(height, area) {
            let tips = '';
            
            if (height > 4.0) {
                tips += `
                    <p><strong>üîù –î–ª—è –≤—ã—Å–æ—Ç—ã ${height}–º:</strong></p>
                    <ul>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–≤–µ—Å–Ω—ã–µ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏ —Å —Ä–µ–≥—É–ª–∏—Ä—É–µ–º–æ–π –¥–ª–∏–Ω–æ–π</li>
                        <li>–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏ —Å —É–∑–∫–∏–º —É–≥–ª–æ–º —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è (30-60¬∞)</li>
                        <li>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ 2-2.5–º –æ—Ç –ø–æ–ª–∞</li>
                        <li>–î–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–µ–º—è–Ω–∫–∞ –≤—ã—Å–æ—Ç–æ–π ${Math.ceil(height - 1)}–º</li>
                    </ul>
                `;
            } else if (height > 3.0) {
                tips += `
                    <p><strong>üìè –î–ª—è –≤—ã—Å–æ—Ç—ã ${height}–º:</strong></p>
                    <ul>
                        <li>–ü–æ–¥–æ–π–¥—É—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–¥–≤–µ—Å–Ω—ã–µ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏</li>
                        <li>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —É–≥–æ–ª —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è: 90-120¬∞</li>
                        <li>–£—á–∏—Ç—ã–≤–∞–π—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤—ã—Å–æ—Ç—ã –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ</li>
                    </ul>
                `;
            }
            
            if (area > 50 && height > 3.5) {
                tips += `
                    <p><strong>‚ö° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –±–æ–ª—å—à–∏—Ö –≤—ã—Å–æ–∫–∏—Ö –ø–æ–º–µ—â–µ–Ω–∏–π:</strong></p>
                    <ul>
                        <li>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ</li>
                        <li>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–µ—Ç–æ–º</li>
                        <li>–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Å–≤–µ—â–µ–Ω–∏–µ–º</li>
                        <li>–¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∏ –º–æ–Ω—Ç–∞–∂</li>
                    </ul>
                `;
            }
            
            return tips || '<p>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –ø–æ–º–µ—â–µ–Ω–∏—è, –ø–æ–¥—Ö–æ–¥—è—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–∏–ø–æ–≤ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–æ–≤.</p>';
        }

        // ==================== –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† ====================
        function validateField(field, min, max, errorElement) {
            const value = parseFloat(field.value);
            
            if (field.value === '' || isNaN(value) || value < min || value > max) {
                field.classList.add('error');
                if (errorElement) errorElement.style.display = 'block';
                return false;
            } else {
                field.classList.remove('error');
                if (errorElement) errorElement.style.display = 'none';
                return true;
            }
        }
        
        function getUtilizationCoefficient(roomTypeText) {
            return COEFFICIENTS.utilization[roomTypeText] || 0.5;
        }
        
        function getComfortMultiplier(roomTypeText) {
            return COEFFICIENTS.comfortMultipliers[roomTypeText] || 1.5;
        }
        
        function getHeightMultiplier(height) {
            for (const level of COEFFICIENTS.heightMultipliers) {
                if (height <= level.max) {
                    return {
                        multiplier: level.multiplier,
                        label: level.label
                    };
                }
            }
            return { multiplier: 6.0, label: '–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞' };
        }
        
        function generateLampOptions() {
            lampsGrid.innerHTML = '';
            
            const basicLamps = [
                { power: 6, lumens: 510, socket: 'E14', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π' },
                { power: 9, lumens: 765, socket: 'E14', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π' },
                { power: 14, lumens: 1150, socket: 'E14', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π' },
                { power: 20, lumens: 1700, socket: 'E27', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π' },
                { power: 30, lumens: 2550, socket: 'E27', name: '–ú–æ—â–Ω—ã–π' },
                { power: 50, lumens: 4250, socket: 'E27', name: '–ö—Ä—É–ø–Ω—ã–π' }
            ];
            
            basicLamps.forEach((lamp, index) => {
                const lampCount = Math.ceil(requiredLumens / lamp.lumens);
                const lampOption = document.createElement('div');
                lampOption.className = `lamp-option ${index === 3 ? 'selected' : ''}`;
                
                lampOption.innerHTML = `
                    <div class="lamp-power">${lamp.power} –í—Ç</div>
                    <div class="lamp-lumens">${lamp.lumens.toLocaleString()} –ª–º</div>
                    <div class="lamp-count">${lampCount} —à—Ç.</div>
                    <div class="lamp-socket">${lamp.socket}</div>
                `;
                
                lampOption.addEventListener('click', () => {
                    document.querySelectorAll('.lamp-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    lampOption.classList.add('selected');
                    
                    lampsResult.textContent = lampCount;
                    lampsUnit.textContent = `—à—Ç √ó ${lamp.lumens.toLocaleString()}–ª–º`;
                });
                
                lampsGrid.appendChild(lampOption);
            });
        }
        
        function calculateIllumination() {
            const isValid = validateField(lengthInput, 0.1, 100, document.getElementById('lengthError')) &&
                          validateField(widthInput, 0.1, 100, document.getElementById('widthError')) &&
                          validateField(heightInput, 1.5, 15, document.getElementById('heightError'));
            
            if (!isValid) {
                resultsDiv.style.display = 'none';
                emptyResultsDiv.style.display = 'block';
                aiAnalyzeBtn.disabled = true;
                return;
            }
            
            const length = parseFloat(lengthInput.value);
            const width = parseFloat(widthInput.value);
            const height = parseFloat(heightInput.value);
            const area = length * width;
            
            let baseLux;
            let roomTypeText;
            
            if (roomTypeSelect.value === 'custom') {
                baseLux = parseInt(customLux.value) || 150;
                roomTypeText = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π...';
                if (baseLux < 1) baseLux = 1;
                if (baseLux > 10000) baseLux = 10000;
                customLux.value = baseLux;
            } else {
                baseLux = parseInt(roomTypeSelect.value) || 150;
                roomTypeText = roomTypeSelect.options[roomTypeSelect.selectedIndex].text;
            }
            
            let targetLux = baseLux;
            let modeText = '–°–ù–∏–ü';
            
            if (currentMode === 'comfort') {
                const comfortMultiplier = getComfortMultiplier(roomTypeText);
                targetLux = Math.round(baseLux * comfortMultiplier);
                modeText = '–ö–æ–º—Ñ–æ—Ä—Ç';
            }
            
            const utilizationCoefficient = getUtilizationCoefficient(roomTypeText);
            const reserveCoefficient = COEFFICIENTS.reserve;
            const heightData = getHeightMultiplier(height);
            heightMultiplierValue = heightData.multiplier;
            
            requiredLumens = Math.round((targetLux * area * reserveCoefficient * heightMultiplierValue) / utilizationCoefficient);
            
            const defaultLampPower = 20;
            const defaultLampLumens = 1700;
            const defaultLampCount = Math.ceil(requiredLumens / defaultLampLumens);
            
            calculationData = {
                length,
                width,
                height,
                area,
                baseLux,
                roomTypeText,
                targetLux,
                modeText,
                currentMode,
                utilizationCoefficient,
                reserveCoefficient,
                heightMultiplierValue,
                heightLabel: heightData.label,
                requiredLumens,
                date: new Date().toLocaleString()
            };
            
            areaResult.textContent = area.toFixed(1);
            luxResult.textContent = targetLux;
            lumenResult.textContent = requiredLumens.toLocaleString();
            lampsResult.textContent = defaultLampCount;
            
            luxUnit.textContent = `–ª–∫ (${modeText})`;
            totalLuxResult.textContent = `${targetLux} –ª–∫ (${modeText})`;
            modeLabel.textContent = currentMode === 'snip' 
                ? '–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –°–ù–∏–ü' 
                : '–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –≥–ª–∞–∑';
            
            const totalMultiplierValue = ((reserveCoefficient * heightMultiplierValue) / utilizationCoefficient).toFixed(2);
coefficientValue.textContent = utilizationCoefficient;
reserveValue.textContent = reserveCoefficient.toFixed(1);
heightCoefficient.textContent = heightMultiplierValue.toFixed(1);
totalMultiplier.textContent = totalMultiplierValue;
            
            if (height > 3.0) {
                heightWarning.classList.add('active');
                heightMultiplier.textContent = `√ó${heightMultiplierValue.toFixed(1)} (${heightData.label})`;
            } else {
                heightWarning.classList.remove('active');
            }
            
            aiAnalyzeBtn.disabled = false;
            
            if (lampsSection.classList.contains('active')) {
                generateLampOptions();
            }
            
            emptyResultsDiv.style.display = 'none';
            resultsDiv.style.display = 'block';
        }
        
        let calculationTimeout;
        function debouncedCalculate() {
            clearTimeout(calculationTimeout);
            calculationTimeout = setTimeout(calculateIllumination, 300);
        }

        // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ====================
        calculateBtn.addEventListener('click', calculateIllumination);
        
        lengthInput.addEventListener('input', debouncedCalculate);
        widthInput.addEventListener('input', debouncedCalculate);
        heightInput.addEventListener('input', debouncedCalculate);
        roomTypeSelect.addEventListener('change', debouncedCalculate);
        
        function restoreValueIfEmpty(field, defaultValue) {
            if (field.value === '') {
                field.value = defaultValue;
                field.classList.remove('error');
                const errorId = field.id + 'Error';
                const errorElement = document.getElementById(errorId);
                if (errorElement) errorElement.style.display = 'none';
                debouncedCalculate();
            }
        }
        
        lengthInput.addEventListener('blur', () => restoreValueIfEmpty(lengthInput, 5.0));
        widthInput.addEventListener('blur', () => restoreValueIfEmpty(widthInput, 4.0));
        heightInput.addEventListener('blur', () => restoreValueIfEmpty(heightInput, 2.7));

        // ==================== –ö–ù–û–ü–ö–ê –í–´–ë–û–†–ê –õ–ê–ú–ü ====================
        lampsToggleBtn.addEventListener('click', () => {
            lampsSection.classList.toggle('active');
            if (lampsSection.classList.contains('active')) {
                lampsToggleBtn.innerHTML = '<i class="fas fa-times"></i> –°–∫—Ä—ã—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã –ª–∞–º–ø';
                generateLampOptions();
            } else {
                lampsToggleBtn.innerHTML = '<i class="fas fa-lightbulb"></i> –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –ª–∞–º–ø';
            }
        });

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        window.addEventListener('load', () => {
            calculateIllumination();
            
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s';
            
            setTimeout(() => {
                document.body.style.opacity = '1';
                lengthInput.focus();
            }, 100);
        });
    </script>
</body>
</html>